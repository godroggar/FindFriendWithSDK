{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\SDK/assets\\Script\\SDK\\facebook.js"],"names":["Utils","require","SDK_AD","GAME_CHECK_URL","GAME_RECOMMEND_URL","GAME_STAT_URL","ELoadState","AD_LOADING","AD_LOAD_SUCCESS","AD_LOAD_FAIL","AD_COMPLETE","sdkADName","video_ad_ids","interstitial_ad_ids","game_id","interstitialCount","videoOn","interstitialOn","interstitialOp","rankName_friends","rankName_world","MyPlayer","FB_SDK","cb","videoAd","videoAdState","InterstitialAd","InterstitialAdState","playTimes","sdk_ad","prototype","init","initOP","FBInstant","i18n","name","player","getName","cc","loader","load","getPhoto","err","texture","head","SpriteFrame","id","getID","locale","getLocale","self","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","console","log","code","data","interstitial_op","interstitial_count","video_on","interstitial_on","setUp","open","SDK","getGameId","setRequestHeader","send","sdkADNode","find","getComponent","reLoadOpAd","rows","pic","pic3","gid","setAd","getRecommendGames","amount","numCount","getItem","key","temp","sys","localStorage","setItem","score","getDataAsync","then","param","p","setDataAsync","canCreateShortcutAsync","canCreateShortcut","createShortcutAsync","catch","switchGameAsync","e","getCatalogAsync","payments","catalog","purchaseAsync","productID","developerPayload","purchase","getPurchasesAsync","purchases","consumePurchaseAsync","purchaseToken","share","context","chooseAsync","doShare","en_text","cn_text","framePath","loadRes","Texture2D","canvas","document","createElement","ctx","getContext","width","height","image","getHtmlElementObj","drawImage","base64Picture","toDataURL","updateAsync","action","cta","template","text","myReplayData","strategy","notification","shareBestScore3Times","t","now","Math","floor","Date","shareBestScore","isCompleted","bind","plusPlayTimes","getInterstitialCount","delayTime","random","setTimeout","showInterstitialAd","openVideoAd","openinterstitialAd","isPlayOpAD","test","random0To1","loadInterstitialAd","getInterstitialAdAsync","interstitial","loadAsync","noOp","GetRandomNum","show","stat","showAsync","loadVideoAd","getRewardedVideoAsync","rewardedVideo","hasVideoAd","showVideoAd","type","playWith","createAsync","getSelfInfo","setRankScore","extra","rankName","contextID","getType","getLeaderboardAsync","leaderboard","setScoreAsync","error","getRankScore","getPlayerEntryAsync","info","entry","getPlayer","no","getRank","getScore","headUrl","getPercent","getEntryCountAsync","count","num","offset","playerList","getEntriesAsync","i","entries","length","getFriendsRank","getConnectedPlayerEntriesAsync","No","postRankToMessage","module","exports","instance"],"mappings":"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","file":"facebook.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\SDK","sourcesContent":["var Utils = require(\"./utils/SDKUtils\");\nvar SDK_AD = require(\"./script/sdk_ad\");\nvar GAME_CHECK_URL = \"https://baidu.com:8003/games.detail\";\nvar GAME_RECOMMEND_URL = \"https://baidu.com:8003/games.recommend\";\nvar GAME_STAT_URL = \"https://baidu.com:8003/games.stat\";\n\nvar ELoadState = {\n    AD_LOADING: \"AD_LOADING\",\n    AD_LOAD_SUCCESS: \"AD_LOAD_SUCCESS\",\n    AD_LOAD_FAIL: \"AD_LOAD_FAIL\",\n    AD_COMPLETE: \"AD_COMPLETE\"\n};\n\n//SDK广告node的路径\nvar sdkADName = \"Canvas/sdk_ad\";\n//视频广告ID\nvar video_ad_ids = '281530152603837_281532319270287';\n//插屏广告ID\nvar interstitial_ad_ids = '281530152603837_281531689270350';\n//游戏ID\nvar game_id = \"281530152603837\";\n\n\n\n//广告配置为默认配置，进入游戏后会加载服务器配置，如果服务器读取失败，使用默认配置。\n//每玩N局播一次插屏广告，如果<=1，代表每次播放\nvar interstitialCount = 2;\n//是否播放视频广告\nvar videoOn = 1;\n//是否播放插屏广告\nvar interstitialOn = 1; \n//是否播放互推插屏广告\nvar interstitialOp = 0;\n//好友榜单名（目前暂时不用）\nvar rankName_friends = \"Friends\";\n//世界榜单名\nvar rankName_world = \"World\";\n\nvar MyPlayer = {}\n\nvar FB_SDK = function () {\n    this.cb = null;\n    this.videoAd = null;\n    this.videoAdState = null;\n    this.InterstitialAd = null;\n    this.InterstitialAdState = null;\n    this.playTimes = 0;\n\n    this.sdk_ad = null;\n};\n\n/**\n * =========================================================\n    * 初始化\n * =========================================================\n**/\n\n/**\n    初始化\n    1）执行初始化服务器配置\n    2）加载视频广告、插屏广告\n    3）设置语言\n*/\nFB_SDK.prototype.init = function () {\n\n    this.initOP();\n    if (typeof FBInstant === 'undefined') {\n        const i18n = require('LanguageData');\n        // i18n.init('zh');\n        //i18n.init('en');\n        return;\n\n    }\n    // console.log(\"playerID\",FBInstant.player.getID());\n    this.playTimes = 0;\n\n    //预加载视频广告和插屏广告\n    //this.loadVideoAd();\n    //this.loadInterstitialAd();\n\n    MyPlayer.name = FBInstant.player.getName();\n    cc.loader.load(FBInstant.player.getPhoto(), function (err, texture) {\n        MyPlayer.head = new cc.SpriteFrame(texture);\n    });\n    MyPlayer.id = FBInstant.player.getID();\n\n    var locale = this.getLocale(); // 'en_US'\n    /* //根据语言配置\n    if (locale == 'zh_CN') {\n        const i18n = require('LanguageData');\n        i18n.init('zh');\n    } else {\n        const i18n = require('LanguageData');\n        i18n.init('en');\n    } */\n};\n\n/**\n * 初始化服务器对游戏的配置\n**/\nFB_SDK.prototype.initOP = function () {\n\n    //从服务器加载初始化数据\n    // cc.log(\"[gameCheck]\" + GAME_CHECK_URL);\n    var self = this;\n    var xhr = new XMLHttpRequest();\n    xhr.onreadystatechange = function () {\n        if (xhr.readyState == 4 && (xhr.status == 200)) {\n            var response = JSON.parse(xhr.responseText);\n            console.log(\"response\", response);\n            var code = response.code;\n            if (code != 500) {\n                // cb(true,response);\n\n                var data = response.data;\n\n                var interstitial_op = data.interstitial_op;     //每10局显示几次互推\n                var interstitial_count = data.interstitial_count;  //每多少局显示一次插屏广告\n                var video_on = data.video_on;    //是否显示视频广告\n                var interstitial_on = data.interstitial_on;   //是否显示插屏广告\n                self.setUp(video_on, interstitial_on, interstitial_count, interstitial_op);\n            }\n        }\n    };\n\n    xhr.open(\"GET\", GAME_CHECK_URL + \"?game_id=\" + SDK().getGameId(), true);\n    xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n    xhr.send();\n};\n\n\n/**\n * 根据后台配置，设置属性\n**/\nFB_SDK.prototype.setUp = function (video_on, interstitial_on, interstitial_count, interstitial_op) {\n    // console.log(\"setUp__interstitialCount\",interstitial_count)\n    // console.log(\"interstitialCount\",interstitialCount)\n    interstitialCount = interstitial_count;\n    videoOn = video_on;\n    interstitialOn = interstitial_on;\n    interstitialOp = interstitial_op;\n\n    // console.log(\"interstitialCount:\",interstitialCount);\n    if (interstitialOn >= 1 && interstitialOp >= 1) {\n        var sdkADNode = cc.find(sdkADName);\n        if (sdkADNode != null) {\n            this.sdk_ad = sdkADNode.getComponent(SDK_AD);\n        }\n\n        //加载互推广告\n        this.reLoadOpAd();\n    }\n};\n\n\n/**\n * 重新加载互推插屏广告\n**/\nFB_SDK.prototype.reLoadOpAd = function () {\n\n    if (this.sdk_ad != null && interstitialOn >= 1 && interstitialOp >= 1) {\n        var self = this;\n        var xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState == 4 && (xhr.status == 200)) {\n                var response = JSON.parse(xhr.responseText);\n                // console.log(\"______________response\",response);\n                var code = response.code;\n                if (code != 500) {\n                    // cb(true,response);\n                    var data = response.data.rows[0];\n                    if (data != null) {\n                        var pic = data.pic3;\n                        var gid = data.game_id;\n                        self.sdk_ad.setAd(pic, gid);\n                    }\n                }\n            }\n        };\n\n        xhr.open(\"GET\", GAME_RECOMMEND_URL + \"?game_id=\" + game_id + \"&amount=1\", true);\n        xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n        xhr.send();\n\n        // console.log(GAME_RECOMMEND_URL + \"?game_id=\"+game_id +\"&amount=1\")\n    }\n};\n\n/**\n * 重新加载互推插屏广告\n**/\nFB_SDK.prototype.getRecommendGames = function (amount, cb) {\n\n    var self = this;\n    var xhr = new XMLHttpRequest();\n    xhr.onreadystatechange = function () {\n        if (xhr.readyState == 4 && (xhr.status == 200)) {\n            var response = JSON.parse(xhr.responseText);\n            // console.log(\"______________response\",response);\n            var code = response.code;\n            if (code != 500) {\n                if (cb != null) {\n                    cb(true, response);\n                }\n            } else {\n                if (cb != null) {\n                    cb(false, {});\n                }\n\n            }\n        }\n    };\n\n    xhr.open(\"GET\", GAME_RECOMMEND_URL + \"?game_id=\" + game_id + \"&amount=\" + amount, true);\n    xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n    xhr.send();\n\n    //console.log(GAME_RECOMMEND_URL + \"?game_id=\" + game_id + \"&amount=\" + amount)\n};\n\n\n// FB_SDK.prototype.setFirstItem=function(){\n//     cc.sys.localStorage.setItem(\"1_1\",\"1\");\n//     cc.sys.localStorage.setItem(\"1_1_1\", \"1\");\n//     cc.sys.localStorage.setItem(\"1_1_1_moves\", \"16\");\n//     cc.sys.localStorage.setItem(\"all\",\"1\");\n//     cc.sys.localStorage.setItem(\"coins\", \"100\");\n//     cc.sys.localStorage.setItem(\"curIdx\", \"1\");\n//     cc.sys.localStorage.setItem(\"debug\",\"undefined\");\n//     cc.sys.localStorage.setItem(\"giftTime\", \"1568707677\");\n//     cc.sys.localStorage.setItem(\"hearts\", \"4\");\n//     cc.sys.localStorage.setItem(\"my_help\", \"5\");\n//     cc.sys.localStorage.setItem(\"reHeart\",\"1\");\n// }\n\n/**\n * =========================================================\n    * 保存、读取数据\n * =========================================================\n**/\n\n/**\n * 获得用户属性（一般来说可以获得设置的分数，以及用户的其他属性）\n**/\nvar numCount = 0;\nFB_SDK.prototype.getItem = function (key, cb) {\n\n    //平台开发者工具无法解析json里没有的字段，所以这么写\n    \n    var temp = cc.sys.localStorage.getItem(key);\n    //console.log(\"key:\"+key+\"……\"+\"value:\"+cc.sys.localStorage.getItem(key));\n    if(temp==null||temp===null||temp==\"\"||temp=='undefined'){\n        cc.sys.localStorage.setItem(key,null);\n    }\n    \n    if (typeof FBInstant === 'undefined') {\n            var score = JSON.parse(cc.sys.localStorage.getItem(key));\n            if (typeof score === 'undefined' || score == null) {\n                score = 0;\n            }\n            cb(score, key);\n    } else {\n        var score = 0;\n        FBInstant.player\n            .getDataAsync(['' + key])\n            .then(function (data) {\n                //console.log('data is loaded',key,data[key]);\n                if (typeof data[key] === 'undefined') {\n                    score = 0;\n                    //console.log(key+\"+null\")\n                } else {\n                    score = data[key];\n                }\n                cb(score, key);\n            });\n    }\n};\n\n\n\n/**\n * 设置属性，如记录分数、记录各类和用户相关的属性\n * param要传递一个对象进来，如{score:100}\n**/\nFB_SDK.prototype.setItem = function (param, cb) {\n    if (typeof FBInstant === 'undefined') {\n        for (var p in param) {//遍历json对象的每个key/value对,p为key\n            // cc.log(\"setScore:\"+ p + \"_\" + param[p]);\n            cc.sys.localStorage.setItem(p, param[p]);\n        }\n        // \n        if (cb != null) {\n            cb();\n        }\n    } else {\n        FBInstant.player\n            .setDataAsync(param)\n            .then(function () {\n                if (cb != null) {\n                    cb();\n                }\n                // console.log('------------data is set',param);\n            });\n    }\n};\n\n/**\n * =========================================================\n    * 基础接口\n * =========================================================\n**/\n\n/**\n * 获得用户的国家地区语言\n**/\nFB_SDK.prototype.getLocale = function () {\n    if (typeof FBInstant === 'undefined') return;\n\n    return FBInstant.getLocale();\n};\n\n/**\n * 获得游戏ID\n**/\nFB_SDK.prototype.getGameId = function () {\n    return game_id;\n};\n\n/**\n * 获得玩家昵称\n**/\nFB_SDK.prototype.getName = function () {\n    if (typeof FBInstant === 'undefined') return \"undefined\";\n    return FBInstant.player.getName();\n};\n\n/**\n * 创建桌面快捷方式\n**/\nFB_SDK.prototype.canCreateShortcutAsync = function (cb) {\n    if (typeof FBInstant === 'undefined') return;\n\n    FBInstant.canCreateShortcutAsync()\n        .then(function (canCreateShortcut) {\n            if (canCreateShortcut) {\n                FBInstant.createShortcutAsync()\n                    .then(function () {\n                        // Shortcut created\n                        if (cb != null) {\n                            cb(true);\n                        }\n                    })\n                    .catch(function () {\n                        // Shortcut not created\n                        if (cb != null) {\n                            cb(false);\n                        }\n                    });\n            } else {\n                if (cb != null) {\n                    cb(false);\n                }\n            }\n        });\n};\n\n/**\n * 切换到别的游戏（互推游戏）\n**/\nFB_SDK.prototype.switchGameAsync = function (game_id) {\n    if (typeof FBInstant === 'undefined') return false;\n    FBInstant.switchGameAsync(game_id).catch(function (e) {\n        // Handle game change failure\n    });\n};\n\n/**\n * =========================================================\n    * 支付相关\n * =========================================================\n**/\n\n/**\n * 获取游戏商品目录\n * （列表是后台添加的列表）\n**/\nFB_SDK.prototype.getCatalogAsync = function (cb) {\n    if (typeof FBInstant === 'undefined') {\n        if (cb != null) {\n            cb([]);\n        }\n        return;\n    }\n\n    FBInstant.payments.getCatalogAsync().then(function (catalog) {\n        console.log(catalog); // [{productID: '12345', ...}, ...]\n        cb(catalog);\n    });\n};\n\n/**\n * 支付\n * 支付成功后，返回支付订单。然后调用consumePurchaseAsync使用，使用后发放道具。\n**/\nFB_SDK.prototype.purchaseAsync = function (productID, developerPayload, cb) {\n\n    if (typeof FBInstant === 'undefined') {\n        if (cb != null) {\n            cb(false, null);\n        }\n        return;\n    }\n\n    FBInstant.payments.purchaseAsync({\n        productID: productID,\n        developerPayload: developerPayload,\n    }).then(function (purchase) {\n        console.log(true, purchase);\n        cb(purchase);\n        // {productID: '12345', purchaseToken: '54321', developerPayload: 'foobar', ...}\n    }).catch(function (e) {\n        cb(false, null);\n    });\n};\n\n/**\n * 获取未消费的支付列表\n * (可能出现的原因是，支付成功后，断网或没有拿到订单)\n * 即：每次进入游戏后，应该请求一下是否有已支付未消费的订单。\n**/\nFB_SDK.prototype.getPurchasesAsync = function (cb) {\n\n    if (typeof FBInstant === 'undefined') {\n        if (cb != null) {\n            cb(false, null);\n        }\n        return;\n    }\n\n    FBInstant.payments.getPurchasesAsync().then(function (purchases) {\n        cb(purchases);\n        // [{productID: '12345', ...}, ...]\n    }).catch(function (e) {\n        cb([]);\n    });\n};\n\n\n/**\n * 消费已支付的订单（一定要在发物品、道具之前调用这个接口，返回成功后才能发放物品）\n * purchaseToken 为支付成功的purchaseToken\n**/\nFB_SDK.prototype.consumePurchaseAsync = function (purchaseToken, cb) {\n\n    if (typeof FBInstant === 'undefined') {\n        if (cb != null) {\n            cb(false, null);\n        }\n        return;\n    }\n\n    FBInstant.payments.consumePurchaseAsync(purchaseToken).then(function () {\n        // Purchase successfully consumed!\n        // Game should now provision the product to the player\n        cb(true);\n    }).catch(function (e) {\n        cb(false);\n    });\n};\n\n\n\n/**\n * =========================================================\n    * 分享\n * =========================================================\n**/\n\n\n/**\n * 分享分数\n**/\nFB_SDK.prototype.share = function (score, cb) {\n    if (typeof FBInstant === 'undefined') {\n        if (cb != null) {\n            cb(true);\n        }\n        return;\n    }\n    var self = this;\n\n    FBInstant.context\n        .chooseAsync()\n        .then(function () {\n            // console.log(\"FBInstant.context.getID():\",FBInstant.context.getID());\n            self.doShare(score);\n            if (cb != null) {\n                cb(true);\n            }\n        }\n        ).catch(function (e) {\n            // console.log(\"catch\",e);\n            if (e.code != null && e.code == \"SAME_CONTEXT\") {\n                //相同的用户或group，不能再次发消息\n                if (cb != null) {\n                    cb(false);\n                }\n            }\n        });\n};\n\n/**\n * 执行分享动作\n * 并读取resources/texture2d/game_icon.png 作为分享图片\n**/\nFB_SDK.prototype.doShare = function (score) {\n    var self = this;\n    var en_text = self.getName() + \" finish \" + score + \" stars,Can you beat me?\";\n    var cn_text = self.getName() + \"向你发起挑战！他已经到了 \" + score + \" 层！\";\n    // console.log(\"share:\"+en_text);\n\n    var framePath = \"texture2d/game_icon\";\n    // console.log(\"framePath:\",framePath)\n    cc.loader.loadRes(framePath, cc.Texture2D, function (err, texture) {\n        let canvas = document.createElement('canvas');\n        let ctx = canvas.getContext('2d');\n        canvas.width = 600;\n        canvas.height = 420;\n\n        let image = texture.getHtmlElementObj();\n        ctx.drawImage(image, 0, 0);\n\n        var base64Picture = canvas.toDataURL('image/png');\n\n        FBInstant.updateAsync({\n            action: 'CUSTOM',\n            cta: 'Play Game',\n            template: 'join_fight',\n            image: base64Picture,\n            text: en_text,\n            data: { myReplayData: '...' },\n            strategy: 'IMMEDIATE',\n            notification: 'NO_PUSH',\n        }).then(function () {\n            //当消息发送后\n            // console.log(\"____当消息发送后\")\n        });\n    });\n};\n\n/**\n * 每三分钟提示分享，并分享最高分数\n * 并读取resources/texture2d/game_icon.png 作为分享图片\n**/\nFB_SDK.prototype.shareBestScore3Times = function (key) {\n    SDK().getItem(\"share_times\", function (t) {\n        //如果没有设置过倒计时，那么设置为3分钟\n        var now = Math.floor(Date.now() / 1000);\n        // console.log(\"t:\",t)\n        // console.log(\"t-now:\",t-now)\n        if (t == null || t <= 0 || t - now < 0) {\n            var param = {};\n            param['share_times'] = now + 180;\n            SDK().setItem(param, function () {\n                SDK().shareBestScore(key);\n            });\n        }\n    });\n};\n\n/**\n * 分享最高分数\n * 并读取resources/texture2d/game_icon.png 作为分享图片\n**/\nFB_SDK.prototype.shareBestScore = function (key, cb) {\n    if (key == null || key == \"\") {\n        key = \"all\";\n    }\n    this.getItem(key, function (score) {\n        SDK().share(score, function (isCompleted) {\n            if (cb) {\n                cb(isCompleted)\n            }\n        });\n    }.bind(this));\n};\n\n\n/**\n * =========================================================\n    * 广告相关\n * =========================================================\n**/\n\n/**\n * 游戏次数+1\n**/\nFB_SDK.prototype.plusPlayTimes = function () {\n\n    this.playTimes++;\n    if ((this.playTimes > 1 && this.playTimes % this.getInterstitialCount() == 0 && this.playTimes >= this.getInterstitialCount()) || (this.getInterstitialCount() <= 1 && this.playTimes > 1)) {\n        var delayTime = 200 + Math.random() * 1000;\n        setTimeout(function () {\n            this.showInterstitialAd(function (isCompleted) {\n                console.log(\"播放Done\");\n            }, false);\n        }.bind(this), delayTime);\n    }\n\n    if(this.playTimes % 5 == 0){\n        this.canCreateShortcutAsync();\n    }\n    if (this.playTimes == 5) {\n        this.shareBestScore(\"all\", null);\n    }\n};\n\n\n/**\n * 是否打开视频广告\n**/\nFB_SDK.prototype.openVideoAd = function () {\n    return videoOn >= 1;\n};\n\n/**\n * 是否打开插屏广告\n**/\nFB_SDK.prototype.openinterstitialAd = function () {\n    return interstitialOn >= 1;\n};\n\n/**\n * 每玩多少局播放一次插屏广告\n**/\nFB_SDK.prototype.getInterstitialCount = function () {\n    return interstitialCount;\n};\n\n//是否显示互推广告（互相推荐自己的游戏）\nFB_SDK.prototype.isPlayOpAD = function () {\n    var test = cc.random0To1() * 10;\n    if (test <= interstitialOp) {\n        return true;\n    } else {\n        return false;\n    }\n};\n\n/**\n * 加载插屏广告\n**/\nFB_SDK.prototype.loadInterstitialAd = function () {\n    if (typeof FBInstant === 'undefined') return;\n    if (!this.openinterstitialAd()) {\n        return;\n    }\n\n    // console.log(\"loadInterstitialAd\")\n    FBInstant.getInterstitialAdAsync(\n        interstitial_ad_ids,\n    ).then(function (interstitial) {\n        // console.log(\"FBInstant.getInterstitialAdAsync:\",interstitial);\n        this.InterstitialAd = interstitial;\n        this.InterstitialAdState = ELoadState.AD_LOADING;\n        return this.InterstitialAd.loadAsync();\n    }.bind(this)).catch(function (e) {\n        // console.log(\"load.showInterstitialAd catch\");\n        // console.log(JSON.stringify(e));\n    }.bind(this))\n        .then(function () {\n            // console.log(\"FBInstant.getInterstitialAdAsync done:\");\n            this.InterstitialAdState = ELoadState.AD_LOAD_SUCCESS;\n        }.bind(this));\n};\n\n/**\n * 播放插屏广告\n**/\nFB_SDK.prototype.showInterstitialAd = function (cb, noOp) {\n\n\n    // console.log(\"FB_SDK.prototype.showInterstitialAd\",this.InterstitialAd);\n    // console.log(\"this.sdk_ad\",this.sdk_ad);\n    // console.log(\"interstitialOn\",interstitialOn);\n\n    if (interstitialOn < 1) {\n        return;\n    }\n\n    if ((this.sdk_ad != null && interstitialOp >= 1 && Utils.GetRandomNum(1, 10) <= interstitialOp && !noOp) || (this.InterstitialAd == null && this.sdk_ad != null && !noOp)) {\n        // if(this.sdk_ad != null){\n        console.log(\"sdk_ad:\", this.sdk_ad)\n        this.sdk_ad.show();\n\n        this.stat(1, this.sdk_ad.game_id);\n        if (cb) {\n            cb(true);\n        }\n\n        // console.log(\"this.sdk_ad.show()\");\n    } else if (this.InterstitialAd != null) {\n        if (typeof FBInstant === 'undefined') {\n            if (cb) {\n                cb(false);\n            }\n            return;\n        };\n\n        // console.log(\"show Interstitial ad start\");\n        this.InterstitialAd.showAsync().then(function () {\n            // console.log(\"this.showInterstitialAd.showAsync\");\n            this.InterstitialAdState = ELoadState.AD_COMPLETE;\n            // this.game.paused = false;\n            // window.sounds.toggleMusic(false);\n            if (cb) {\n                cb(true);\n            }\n\n            // console.log(\"show showInterstitialAd success\");\n            this.loadInterstitialAd();\n        }.bind(this))\n            .catch(function (e) {\n                // console.log(\"this.showInterstitialAd catch\");\n                this.InterstitialAdState = ELoadState.AD_COMPLETE;\n                // this.game.paused = false;\n                // window.sounds.toggleMusic(false);\n                // console.log(JSON.stringify(e));\n                if (cb) {\n                    cb(false);\n                }\n            }.bind(this));\n    } else {\n        // console.log(\"show showInterstitialAd ad Stop\");\n        if (cb) {\n            cb(false);\n        }\n        this.loadInterstitialAd();\n    }\n};\n\n/**\n * 加载视频广告\n**/\nFB_SDK.prototype.loadVideoAd = function () {\n    if (typeof FBInstant === 'undefined') return;\n\n    if (!this.openVideoAd()) {\n        return;\n    }\n    // console.log(\"FB_SDK.prototype.loadVideoAd\");\n    FBInstant.getRewardedVideoAsync(\n        video_ad_ids,\n    ).then(function (rewardedVideo) {\n        this.videoAd = rewardedVideo;\n        this.videoAdState = ELoadState.AD_LOADING;\n        return this.videoAd.loadAsync();\n    }.bind(this)).then(function () {\n        this.videoAdState = ELoadState.AD_LOAD_SUCCESS;\n    }.bind(this));\n};\n\n/**\n * 是否有视频广告可以播放\n**/\nFB_SDK.prototype.hasVideoAd = function () {\n    if (typeof FBInstant === 'undefined') {\n        return false;\n    };\n\n    return this.videoAd != null;\n};\n\n/**\n * 播放视频广告\n**/\nFB_SDK.prototype.showVideoAd = function (cb) {\n    if (typeof FBInstant === 'undefined') {\n        if (cb) {\n            cb(false);\n        }\n        return;\n    };\n\n    // console.log(\"FB_SDK.prototype.showVideoAd\",this.videoAd);\n\n    if (this.videoAd != null) {\n        // console.log(\"show video ad start\");\n        this.videoAd.showAsync().then(function () {\n            // console.log(\"this.videoAd.showAsync\");\n            this.videoAdState = ELoadState.AD_COMPLETE;\n            // this.game.paused = false;\n            // window.sounds.toggleMusic(false);\n            if (cb) {\n                cb(true);\n            }\n\n            // console.log(\"show video ad success\");\n            this.loadVideoAd();\n        }.bind(this))\n            .catch(function (e) {\n                // console.log(\"this.videoAd catch\");\n                this.videoAdState = ELoadState.AD_COMPLETE;\n                // this.game.paused = false;\n                // window.sounds.toggleMusic(false);\n                // console.log(JSON.stringify(e));\n                if (cb) {\n                    cb(false);\n                }\n                this.loadVideoAd();\n            }.bind(this));\n    } else {\n        // console.log(\"show video ad Stop\");\n        if (cb) {\n            cb(false);\n        }\n        this.loadVideoAd();\n    }\n};\n\n\n/**\n * =========================================================\n    * 统计相关\n * =========================================================\n**/\n\n/**\n * 统计显示、点击次数（统计自己的互推广告）\n**/\nFB_SDK.prototype.stat = function (type, gid) {\n    var xhr = new XMLHttpRequest();\n    xhr.onreadystatechange = function () {\n        if (xhr.readyState == 4 && (xhr.status == 200)) {\n            var response = JSON.parse(xhr.responseText);\n            // console.log(\"______________response\",response);\n        }\n    };\n\n    xhr.open(\"GET\", GAME_STAT_URL + \"?game_id=\" + gid + \"&type=\" + type, true);\n    xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n    xhr.send();\n};\n\n\n\n\n/**\n * =========================================================\n    * 榜单\n * =========================================================\n**/\n\n/**\n * 和好友一起玩\n * id 好友ID\n * score 自己的最高分\n * cb callback\n**/\nFB_SDK.prototype.playWith = function (id, score, cb) {\n    if (typeof FBInstant === 'undefined') {\n        if (cb != null) {\n            cb(true);\n        }\n        return;\n    }\n    var self = this;\n    FBInstant.context\n        .createAsync(id)\n        .then(function () {\n            // console.log(\"FBInstant.context.getID():\",FBInstant.context.getID());\n            self.doShare(score);\n            if (cb != null) {\n                cb(true);\n            } else {\n                cb(false);\n            }\n        }).catch(cb(false));\n};\n\n\n\n\n/**\n * 获取自身信息\n * cb callback\n**/\nFB_SDK.prototype.getSelfInfo = function (cb) {\n    if (typeof FBInstant === 'undefined') {\n        console.log(\"set rank fail\");\n        if (cb !== null) {\n            cb({});\n        }\n    } else {\n        if (cb != null) {\n            cb(MyPlayer);\n        }\n        return MyPlayer;\n    }\n}\n\n/**\n * 保存榜单分数\n**/\nFB_SDK.prototype.setRankScore = function (type, score, extra, cb) {\n    if (typeof FBInstant === 'undefined') {\n        console.log(\"set rank fail\");\n    } else {\n        var rankName;\n        var contextID = FBInstant.context.getID();\n        if (contextID != null) {\n            contextID = \".\" + contextID;\n        }\n        if (type == 1) {\n            rankName = rankName_friends;\n            if (contextID == null) {\n                console.log(FBInstant.context.getType());\n                contextID = \"\";\n                return;\n            }\n        } else if (type == 2) {\n            rankName = rankName_world;\n            contextID = \"\";\n        } else {\n            if (null != cb) {\n                cb(\"wrong type\")\n            }\n            console.log(\"wrong type\");\n            return;\n        }\n        FBInstant\n            .getLeaderboardAsync(rankName + contextID)\n            .then(leaderboard => {\n                console.log(leaderboard.getName());\n                return leaderboard.setScoreAsync(score, extra);\n            })\n            .then(() => console.log('Score saved'))\n            .catch(error => console.error(error));\n\n    }\n};\n\n/**\n * 获取自身的排行榜\n**/\nFB_SDK.prototype.getRankScore = function (type, cb) {\n    if (typeof FBInstant === 'undefined') {\n        console.log(\"get self rank fail\");\n    } else {\n        var rankName;\n        var contextID = FBInstant.context.getID();\n        if (contextID != null) {\n            contextID = \".\" + contextID;\n        }\n        if (type == 1) {\n            rankName = rankName_friends;\n            if (contextID == null) {\n                console.log(FBInstant.context.getType());\n                contextID = \"\";\n                return;\n            }\n        } else if (type == 2) {\n            rankName = rankName_world;\n            contextID = \"\";\n        } else {\n            if (null != cb) {\n                cb(\"wrong type\")\n            }\n            console.log(\"wrong type\");\n            return;\n        }\n        FBInstant\n            .getLeaderboardAsync(rankName + contextID)\n            .then(leaderboard => leaderboard.getPlayerEntryAsync())\n            .then(entry => {\n                var info = {};\n                info.id = entry.getPlayer().getID();\n                info.no = entry.getRank();\n                info.name = entry.getPlayer().getName();\n                info.score = entry.getScore();\n                info.headUrl = entry.getPlayer().getPhoto();\n                cb(info);\n            }).catch(error => console.error(error));\n    }\n};\n\n/**\n * 获取榜单百分比\n**/\nFB_SDK.prototype.getPercent = function (cb) {\n    if (typeof FBInstant === 'undefined') {\n        console.log(\"get rank fail\");\n        if (cb != null) {\n            cb();\n        }\n    } else {\n        FBInstant.getLeaderboardAsync('World')\n            .then(function (leaderboard) {\n                return leaderboard.getEntryCountAsync();\n            })\n            .then(function (count) {\n                if (cb != null) {\n                    cb(count);\n                }\n            });\n    }\n}\n\n/**\n * 获取榜单\n**/\nFB_SDK.prototype.getRank = function (type, num, offset, cb) {\n    if (typeof FBInstant === 'undefined') {\n        console.log(\"get rank fail\");\n    } else {\n        var rankName;\n        var contextID = FBInstant.context.getID();\n        if (contextID != null) {\n            contextID = \".\" + contextID;\n        }\n        if (type == 1) {\n            rankName = rankName_friends;\n            if (contextID == null) {\n                console.log(FBInstant.context.getType());\n                contextID = \"\";\n                if (cb != null) {\n                    cb([]);\n                }\n                return;\n            }\n        } else if (type == 2) {\n            rankName = rankName_world;\n            contextID = \"\";\n        } else {\n            if (null != cb) {\n                cb(\"wrong type\")\n            }\n            console.log(\"wrong type\");\n            return;\n        }\n        var playerList = [];\n        FBInstant\n            .getLeaderboardAsync(rankName + contextID)\n            .then(leaderboard => leaderboard.getEntriesAsync(num, offset))//第一个是获取数量，第二个是起始点\n            .then(entries => {\n                for (var i = 0; i < entries.length; i++) {\n                    playerList[i] = {};\n                    playerList[i].id = entries[i].getPlayer().getID();\n                    playerList[i].no = entries[i].getRank();\n                    playerList[i].name = entries[i].getPlayer().getName();\n                    playerList[i].score = entries[i].getScore();\n                    playerList[i].headUrl = entries[i].getPlayer().getPhoto();\n                    /* console.log(\n                        entries[i].getRank() + '. ' +\n                        entries[i].getPlayer().getName() + ': ' +\n                        entries[i].getScore()+ 'url ' +\n                        entries[i].getPlayer().getPhoto()\n                    ); */\n                }\n                if (cb != null) {\n                    cb(playerList);\n                }\n            }).catch(error => console.error(error));\n    }\n};\n\n\n/**\n * 获取好友榜单\n * cb callback\n**/\nFB_SDK.prototype.getFriendsRank = function (type, num, offset, cb) {\n    if (typeof FBInstant === 'undefined') {\n        console.log(\"getFriendsInfo fail\");\n        if (cb != null) {\n            cb({});\n        }\n    } else {\n        var rankName;\n        var contextID = FBInstant.context.getID();\n        if (contextID != null) {\n            contextID = \".\" + contextID;\n        }\n        if (type == 1) {\n            rankName = rankName_friends;\n            if (contextID == null) {\n                console.log(FBInstant.context.getType());\n                contextID = \"\";\n                if (cb != null) {\n                    cb([]);\n                }\n                return;\n            }\n        } else if (type == 2) {\n            rankName = rankName_world;\n            contextID = \"\";\n        } else {\n            if (null != cb) {\n                cb(\"wrong type\")\n            }\n            console.log(\"wrong type\");\n            return;\n        }\n        var playerList = [];\n        FBInstant.getLeaderboardAsync(rankName + contextID).then(\n            leaderboard => leaderboard.getConnectedPlayerEntriesAsync(num, offset)\n        ).then(function (entries) {\n            for (var i = 0; i < entries.length; i = i + 1) {\n                playerList[i] = {};\n                playerList[i].id = entries[i].getPlayer().getID();\n                playerList[i].name = entries[i].getPlayer().getName();\n                playerList[i].headUrl = entries[i].getPlayer().getPhoto();\n                playerList[i].No = entries[i].getRank();\n                playerList[i].score = entries[i].getScore();\n            }\n            if (cb != null) {\n                cb(playerList);\n            }\n        });\n    }\n\n}\n\n\n/**\n * \n**/\nFB_SDK.prototype.postRankToMessage = function (type, cb) {\n    if (typeof FBInstant === 'undefined') {\n        console.log(\"post rank fail\");\n    } else {\n        var rankName;\n        var contextID = FBInstant.context.getID();\n        if (contextID != null) {\n            contextID = \".\" + contextID;\n        }\n        if (type == 1) {\n            rankName = rankName_friends;\n            if (contextID == null) {\n                console.log(FBInstant.context.getType());\n                contextID = \"\";\n                return;\n            }\n        } else if (type == 2) {\n            rankName = rankName_world;\n            contextID = \"\";\n        } else {\n            if (null != cb) {\n                cb(\"wrong type\")\n            }\n            console.log(\"wrong type\");\n            return;\n        }\n        FBInstant.updateAsync({\n            action: 'LEADERBOARD',\n            name: rankName + contextID\n        })\n            .then(() => console.log('Update Posted'))\n            .catch(error => console.error(error));\n    }\n}\n\n/**\n * =========================================================\n    * END\n * =========================================================\n**/\n\nmodule.exports = (function () {\n    var instance;\n    return function () {\n        if (!instance) {\n            instance = new FB_SDK();\n        }\n        return instance;\n    }\n})();\n\n"]}