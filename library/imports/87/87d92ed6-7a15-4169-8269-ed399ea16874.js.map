{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\SDK\\tt/assets\\Script\\SDK\\tt\\TTShare.js"],"names":["TTShare","title","tt","showShareMenu","withShareTicket","updateShareMenu","wx","onShareAppMessage","visibleOrigin","cc","view","getVisibleOrigin","visibleSize","getFrameSize","imageUrl","canvas","toTempFilePathSync","x","y","destWidth","width","destHeight","height","success","console","log","shareSuccess","fail","e","func","isShowRecorder","videoPath","D","sdk","getRecorder","getVideoPath","shareAppMessage","channel","extra","errMsg","indexOf","share","description","shareFlag","shareTicket","getShareInfo","BaseShare"],"mappings":";;;;;;;;;;;;;AACA;;;;;;;;;;;;IACqBA;;;AAEnB,mBAAYC,KAAZ,EAAmB;AAAA;;AAAA,kHACXA,KADW;;AAEjBC,OAAGC,aAAH,CAAiB;AACfC,uBAAiB;AADF,KAAjB;AAGAF,OAAGG,eAAH,CAAmB;AACjBD,uBAAiB;AADA,KAAnB;AAGAE,OAAGC,iBAAH,CAAqB,YAAY;AAAA;;AAC/B;AACA,UAAIC,gBAAgBC,GAAGC,IAAH,CAAQC,gBAAR,EAApB;AACA,UAAIC,cAAcH,GAAGC,IAAH,CAAQG,YAAR,EAAlB;;AAEA,aAAO;AACLZ,eAAOA,KADF;AAELa,kBAAUC,OAAOC,kBAAP,CAA0B;AAClCC,aAAGT,cAAcS,CADiB;AAElCC,aAAGV,cAAcU,CAFiB;AAGlCC,qBAAWP,YAAYQ,KAHW;AAIlCC,sBAAYT,YAAYU;AAJU,SAA1B,CAFL;AAQLC,iBAAS,mBAAM;AACbC,kBAAQC,GAAR,CAAY,MAAZ;AACA,iBAAKC,YAAL;AACD,SAXI;AAYLC,cAAM,cAACC,CAAD,EAAO;AACXJ,kBAAQC,GAAR,CAAY,MAAZ,EAAoBG,CAApB;AACD;AAdI,OAAP;AAgBD,KArBD;AARiB;AA8BlB;;;;0BAEK3B,OAAO4B,MAAMC,gBAAgB;AAAA;;AACjC;;AAEA,UAAIC,YAAYC,EAAEC,GAAF,CAAMC,WAAN,GAAoBC,YAApB,EAAhB;AACAX,cAAQC,GAAR,CAAY,wBAAZ,EAAsCxB,KAAtC,EAA4C,kBAA5C,EAA+D6B,cAA/D,EAA8E,aAA9E,EAA4FC,SAA5F;AACA,UAAID,kBAAkBC,SAAtB,EAAiC;;AAE/B7B,WAAGkC,eAAH,CAAmB;AACjBC,mBAAS,OADQ;AAEjBpC,iBAAOA,SAAS,KAAKA,KAFJ;AAGjBqC,iBAAO;AACLP,uBAAWA;AADN,WAHU;AAMjBR,mBAAS,mBAAM;AACbC,oBAAQC,GAAR,CAAY,MAAZ;AACA,gBAAII,IAAJ,EAAU;AACRA,mBAAK,IAAL;AACD;AACD,mBAAKH,YAAL;AACD,WAZgB;AAajBC,gBAAM,cAACC,CAAD,EAAO;AACXJ,oBAAQC,GAAR,CAAY,MAAZ,EAAoBG,CAApB;AACA,gBAAIA,EAAEW,MAAF,CAASC,OAAT,CAAiB,OAAjB,KAA6B,CAAjC,EAAoC;AAClC,qBAAKC,KAAL,CAAWxC,KAAX,EAAkB4B,IAAlB,EAAwB,KAAxB;AACD,aAFD,MAEO;AACLA,mBAAK,KAAL;AACD;AAGF;AACD;AACA;AACA;AACA;AACA;AACA;AA5BiB,SAAnB;AA8BD,OAhCD,MAgCO;AACL3B,WAAGkC,eAAH,CAAmB;AACjBC,mBAAS,SADQ;AAEjBpC,iBAAO,MAFU;AAGjByC,uBAAazC,SAAS,KAAKA,KAHV;AAIjBsB,mBAAS,mBAAM;AACbC,oBAAQC,GAAR,CAAY,SAAZ;AACA,gBAAII,IAAJ,EAAU;AACRA,mBAAK,IAAL;AACD;AACD,mBAAKH,YAAL;AACD,WAVgB;AAWjBC,gBAAM,cAACC,CAAD,EAAO;AACXC,iBAAK,KAAL;AACAL,oBAAQC,GAAR,CAAY,SAAZ;AACA;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AArBiB,SAAnB;AAuBD;;AAED,WAAKkB,SAAL,GAAiB,IAAjB;AACD;;;iCAEYC,aAAaf,MAAM;AAC9B,UAAIe,WAAJ,EAAiB;AACf1C,WAAG2C,YAAH,CAAgB;AACdD,uBAAaA,WADC;AAEdrB,mBAAS,mBAAM,CAEd,CAJa;AAKdI,gBAAM,gBAAM,CAEX;AAPa,SAAhB;AASD;AAEF;;;;EAjHkCmB;;kBAAhB9C","file":"TTShare.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SDK\\tt","sourcesContent":["\nimport BaseShare from \"../base/BaseShare\";\nexport default class TTShare extends BaseShare {\n\n  constructor(title) {\n    super(title);\n    tt.showShareMenu({\n      withShareTicket: true,\n    });\n    tt.updateShareMenu({\n      withShareTicket: true\n    })\n    wx.onShareAppMessage(function () {\n      // 用户点击了“转发”按钮\n      let visibleOrigin = cc.view.getVisibleOrigin();\n      let visibleSize = cc.view.getFrameSize();\n\n      return {\n        title: title,\n        imageUrl: canvas.toTempFilePathSync({\n          x: visibleOrigin.x,\n          y: visibleOrigin.y,\n          destWidth: visibleSize.width,\n          destHeight: visibleSize.height\n        }),\n        success: () => {\n          console.log('分享成功')\n          this.shareSuccess();\n        },\n        fail: (e) => {\n          console.log('分享失败', e)\n        }\n      }\n    })\n  }\n\n  share(title, func, isShowRecorder) {\n    // this.callback = func;\n  \n    let videoPath = D.sdk.getRecorder().getVideoPath();\n    console.log('shareAppMessage title ', title,' isShowRecorder ',isShowRecorder,' videoPath ',videoPath)\n    if (isShowRecorder && videoPath) {\n      \n      tt.shareAppMessage({\n        channel: 'video',\n        title: title || this.title,\n        extra: {\n          videoPath: videoPath,\n        },\n        success: () => {\n          console.log('分享成功');\n          if (func) {\n            func(true);\n          }\n          this.shareSuccess();\n        },\n        fail: (e) => {\n          console.log('分享失败', e);\n          if (e.errMsg.indexOf('short') >= 0) {\n            this.share(title, func, false)\n          } else {\n            func(false);\n          }\n          \n\n        }\n        // x: visibleOrigin.x,\n        // y: visibleOrigin.y,\n        // imageUrl: canvas.toTempFilePathSync({\n        //   destWidth: visibleSize.width,\n        //   destHeight: visibleSize.height\n        // })\n      })\n    } else {\n      tt.shareAppMessage({\n        channel: 'article',\n        title: '分享创作',\n        description: title || this.title,\n        success: () => {\n          console.log('SDK分享成功');\n          if (func) {\n            func(true);\n          }\n          this.shareSuccess();\n        },\n        fail: (e) => {\n          func(false);\n          console.log('SDK分享失败');\n          // ToastController.instance().show(\"分享失败\")\n        }\n        // x: visibleOrigin.x,\n        // y: visibleOrigin.y,\n        // imageUrl: canvas.toTempFilePathSync({\n        //   destWidth: visibleSize.width,\n        //   destHeight: visibleSize.height\n        // })\n      })\n    }\n\n    this.shareFlag = true;\n  }\n\n  getShareInfo(shareTicket, func) {\n    if (shareTicket) {\n      tt.getShareInfo({\n        shareTicket: shareTicket,\n        success: () => {\n\n        },\n        fail: () => {\n\n        }\n      });\n    }\n\n  }\n\n\n}\n"]}