{"version":3,"sources":["MainView.js"],"names":["stageColor","cc","color","gray","Class","extends","Component","properties","title","default","type","Label","hearts","Node","starts","coins","content","scrollView","ScrollView","stageItem","missionSpriteAtlas","SpriteAtlas","missions","gameApplication","Object","missionNodes","curIdx","Integer","visible","minIdx","maxIdx","uiAtlas","reTime","Float","reviveBtn","Button","reviveTime","reviveNum","onLoad","SDK","getItem","count","string","bind","reviveHeartCount","node","width","winSize","height","window","mainScirpt","find","getComponent","init","on","scorllToBottom","scorllToTop","event","initStage","keys","length","getMissions","results","initContents","score","toString","onEnable","refreashVal","heart","coin","active","lastPlay","val","initMissionItem","initMission","scheduleOnce","menuClick","curMission","judgeType","mission","bigStage","cannonNode","instantiate","parent","name","lockCount","islock","i","item","mlInfo","judgeML","lid","stars","small","Sprite","num","curPoint","lock","runAction","repeatForever","sequence","moveBy","v2","mid","arr","push","forEach","tmp_lid","tmp_path","getConf","stopAllActions","spriteFrame","getSpriteFrame","info","idx","initStageClick","checkstagePass","off","EventType","TOUCH_END","setSiblingIndex","star","stageInfo","goGame","soundManager","playSound","target","substr","showSharaView","isComplited","param","setItem","flyReward","showHeartView","bid","openGameView","stage","disVal","isFix","Math","floor","fixCount","hideAllItem","childrenCount","children","n","destroy","showCoinView","isCompleted","fix","maxScrollOffset","getMaxScrollOffset","scrollToOffset","y","parseInt","reHeart","Heart","abs","temp","tempMin","min","sec","update","dt"],"mappings":"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","file":"MainView.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\UI","sourcesContent":["import { isContext } from \"vm\";\n//需要更多源码联系Q:852183691\n//或者\n//关注微信公众号“史于二”\nvar stageColor = [\n    cc.color(248, 181, 81, 255),\n    cc.color(174, 93, 161, 255),\n    cc.color(50, 177, 108, 255),\n    cc.color(54, 46, 43, 255),\n    cc.color(0, 0, 0, 255),\n    cc.color(0, 160, 233, 255),\n];\nvar gray = cc.color(229, 229, 229, 255);\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        title: {\n            default: null,\n            type: cc.Label,\n        },\n        hearts: {\n            default: null,\n            type: cc.Node,\n        },\n        starts: {\n            default: null,\n            type: cc.Node,\n        },\n        coins: {\n            default: null,\n            type: cc.Node,\n        },\n        content: {\n            default: null,\n            type: cc.Node,\n        },\n        scrollView: {\n            default: null,\n            type: cc.ScrollView,\n        },\n        stageItem: {\n            default: null,\n            type: cc.Node,\n        },\n        missionSpriteAtlas: {\n            default: null,\n            type: cc.SpriteAtlas,\n        },\n        missions: {\n            default: null,\n        },\n        gameApplication: {\n            default: null,\n            type: Object\n        },\n        missionNodes: {\n            default: [],\n        },\n        curIdx: {\n            default: 0,\n            type: cc.Integer,\n            visible: false,\n        },\n        minIdx: {\n            default: 0,\n            type: cc.Integer,\n            visible: false,\n        },\n        maxIdx: {\n            default: 0,\n            type: cc.Integer,\n            visible: false,\n        },\n        uiAtlas: {\n            default: null,\n            type: cc.SpriteAtlas,\n        },\n        reTime: {\n            default: 0,\n            type: cc.Float,\n            visible: false,\n        },\n        reviveBtn: {\n            default: null,\n            type: cc.Button,\n        },\n        reviveTime: {\n            default: null,\n            type: cc.Label,\n        },\n        reviveNum: {\n            default: null,\n            type: cc.Label,\n        },\n    },\n\n    onLoad: function () {\n        this.reTime = 300;\n        SDK().getItem(\"reHeart\", function (count) {\n            this.reviveNum.string = count;\n        }.bind(this));\n        this.reviveHeartCount();\n        this.node.width = cc.winSize.width;\n        this.node.height = cc.winSize.height;\n        window.mainScirpt = this;\n        this.gameApplication = cc.find(\"GameApplication\").getComponent(\"GameApplication\");\n        this.init();\n        \n        this.scrollView.node.on(\"scroll-to-bottom\", this.scorllToBottom, this);\n\n        this.scrollView.node.on(\"scroll-to-top\", this.scorllToTop, this);\n\n        //scrollView.scrollToOffset(cc.p(maxScrollOffset.x / 2, 0), 0.1);\n\n        this.minIdx = null;\n        this.maxIdx = null;\n    },\n\n    scorllToBottom(event) {\n        if (this.minIdx > 0) {\n            this.initStage(this.minIdx - 10);\n        }\n    },\n\n    scorllToTop(event) {\n        if (this.maxIdx < 540) {\n            this.initStage(this.maxIdx + 10);\n        }\n    },\n\n    init() {\n        if (this.missions == null || Object.keys(this.missions).length <= 0) {\n            this.gameApplication.getMissions(function (results) {\n                this.missions = results;\n                this.initContents();\n            }.bind(this));\n        } else {\n            this.initContents();\n        }\n\n        SDK().getItem(\"all\", function (score) {\n            this.starts.getComponent(cc.Label).string = score.toString();\n        }.bind(this));\n\n    },\n\n    onEnable() {\n        if (this.missions != null && Object.keys(this.missions).length > 0) {\n            this.initContents();\n        }\n        this.refreashVal();\n        //SDK注释\n        //D.sdk.showBanner();\n    },\n\n    refreashVal() {\n        if (this.starts == null) {\n            return;\n        }\n        SDK().getItem(\"all\", function (score) {\n            this.starts.getComponent(cc.Label).string = score.toString();\n        }.bind(this));\n\n        SDK().getItem(\"hearts\", function (heart) {\n            this.hearts.getComponent(cc.Label).string = heart.toString();\n        }.bind(this));\n\n        SDK().getItem(\"coins\", function (coin) {\n            this.coins.getComponent(cc.Label).string = coin.toString();\n        }.bind(this));\n    },\n\n    //初始化地图\n    initContents() {\n        this.content.active = false;\n        if (window.lastPlay != null) {\n            this.initStage(window.lastPlay);\n            this.content.active = true;\n        } else {\n            SDK().getItem(\"curIdx\", function (val) {\n                if (val == null) {\n                    val = 0;\n                }\n                window.curIdx = val\n                this.initMissionItem(val);\n                this.content.active = true;\n            }.bind(this));\n        }\n    },\n\n    //第一次加载关卡\n    initMissionItem(val) {\n        var initMission;\n        if (val >= 10) {\n            this.initStage(val - 10);\n        }\n        this.initStage(val);\n        if (val < 540) {\n            this.initStage(val + 10);\n        }\n        this.scheduleOnce(function () {\n            this.menuClick(null, \"goCur\");\n        }.bind(this), 2)\n    },\n\n    //加载或刷新一段关卡\n    initStage(val) {\n        var curMission = this.judgeType(val);\n        //console.log(val);\n        var mission =this.missions[curMission.type];\n        \n        var bigStage = curMission.bigStage;\n\n        var cannonNode = this.missionNodes[bigStage];\n        if (cannonNode == null) {\n            cannonNode = cc.instantiate(this.stageItem);\n        }\n\n        cannonNode.parent = this.content;\n        cannonNode.name = \"\" + bigStage;\n        //console.log(cannonNode.tag);\n        //cannonNode.tag = curMission.type;\n\n        //获取大关是否解锁\n        SDK().getItem(\"lock_\" + bigStage, function (lockCount) {\n            var islock = false;\n            if (lockCount > 0) {\n                islock = false;\n            }\n            if (bigStage == 0) {\n                islock = false;\n            }\n            //获取每十关的小关卡并初始化\n            for (var i = 0; i < 10; i = i + 1) {\n                //获取单个小关卡并计算小关卡是第几关\n                var item = cc.find(\"Bg/Stage\" + i, cannonNode);\n                var val = i + bigStage;\n\n                //判断章节和关卡\n                let mlInfo = this.judgeML(curMission, i);\n                //console.log(\"item.tag:\"+item.tag);\n                \n                //item.tag = val;\n\n                //如果该小关不存在则隐藏\n                if (mlInfo.lid > mission.stars) {\n                    item.active = false;\n                } else {\n                    item.active = true;\n\n                    //获取当前小关卡的所有组件\n                    var small = cc.find(\"Small\", item).getComponent(cc.Sprite);\n                    var num = cc.find(\"Num\", small.node).getComponent(cc.Label);\n                    var curPoint = cc.find(\"CurPoint\", small.node);\n                    var lock = cc.find(\"Lock\", small.node);\n\n                    //设置关卡名\n                    if (val % 10 == 0) {\n                        num.string = \"\";\n                        if (val == 0) {\n                            num.string = \"\";\n                        }\n                    } else {\n                        num.string = val;\n                    }\n\n                    //判断是否是当前关卡\n                    if (val == window.curIdx) {\n                        curPoint.active = true;\n                        curPoint.runAction(\n                            cc.repeatForever(\n                                cc.sequence(\n                                    cc.moveBy(0.5, cc.v2(0, 20)),\n                                    cc.moveBy(0.5, cc.v2(0, -20))\n                                )\n                            )\n                        )\n                        //预加载关卡\n                        var mid = mlInfo.mid;\n                        var lid = mlInfo.lid;\n                        if (mid != null && mid > 0 && lid != null && lid > 0) {\n                            //预加载上下两关\n                            var arr = [];\n                            if (lid > 1) {\n                                arr.push(lid - 1);\n                            }\n                            arr.push(lid);\n                            if (lid < 100) {\n                                arr.push(lid + 1);\n                            }\n                            arr.forEach(function (tmp_lid) {\n                                var tmp_path = \"conf/level_detail/b_\" + 1 + \"/\" + mid + \"/\" + tmp_lid;\n                                window.gameApplication.getConf(tmp_path, null);\n                            });\n                        }\n                    } else {\n                        curPoint.stopAllActions();\n                        curPoint.active = false;\n                    }\n\n                    //设置图标的样式\n                    if (val == bigStage) {\n                        small.spriteFrame = this.uiAtlas.getSpriteFrame(curMission.type + \"Big\");\n                        small.node.color = cc.color(255,255,255,255);\n                    } else {\n                        small.node.color = gray;\n                    }\n\n                    //是否解锁\n                    if (!islock) {\n                        lock.active = false;\n\n                        //封装关卡信息\n                        var info = {};\n                        info.mid = mlInfo.mid;\n                        info.lid = mlInfo.lid;\n                        info.bigStage = curMission.bigStage;\n                        info.idx = i;\n\n                        //初始化按钮事件\n\t\t\t\t\t\t//cc.log(\"call button : \"+ val + \" window.curIdx:\" + window.curIdx);\n                        if (val <= window.curIdx || true) {\n                            this.initStageClick(info, item, islock);\n                        }\n                        this.checkstagePass(mlInfo, val, small, curMission)\n                    } else {\n                        lock.active = true;\n                        //解绑点击函数\n                        item.off(cc.Node.EventType.TOUCH_END);\n                        if (val % 10 == 0) {\n                            lock.active = false;\n                            var info = {};\n                            info.mid = mlInfo.mid;\n                            info.lid = mlInfo.lid;\n                            info.bigStage = curMission.bigStage;\n                            info.idx = i;\n                            this.initStageClick(info, item, islock);\n                        }\n                    }\n                }\n            }\n            cannonNode.active = true;\n            this.missionNodes[bigStage] = cannonNode;\n\n            if (bigStage > this.maxIdx || this.maxIdx == null) {\n                this.maxIdx = bigStage;\n            }\n            if (bigStage < this.minIdx || this.minIdx == null) {\n                this.minIdx = bigStage;\n                cannonNode.setSiblingIndex(0);\n            }\n        }.bind(this))\n    },\n\n    //判断小关卡是否过关\n    checkstagePass(mlInfo, val, small, curMission) {\n        //判断是否过关\n        SDK().getItem(\"1_\" + mlInfo.mid + \"_\" + mlInfo.lid, function (star) {\n            \n            if (star > 0) {\n                if (val % 10 != 0) {\n                    small.node.color = stageColor[curMission.type];\n                }\n            }\n        }.bind(this))\n    },\n\n\n    initStageClick(stageInfo, item, islock) {\n        let goGame = cc.find(\"GoGame\", this.node)\n        item.off(cc.Node.EventType.TOUCH_END);\n        //绑定点击函数\n        item.on(cc.Node.EventType.TOUCH_END, function (event) {\n            if (goGame != null) {\n                goGame.active = true;\n            }\n            this.gameApplication.soundManager.playSound(\"btn_click\");\n            var idx = event.target.name.substr(5,6);\n            //被锁住的大关卡的解锁\n            if (idx % 10 == 0 && idx != 0 && islock) {\n                this.gameApplication.showSharaView(function (isComplited) {\n                    if (isComplited) {\n                        var param = {};\n                        param[\"lock_\" + stageInfo.bigStage] = 1;\n                        SDK().setItem(param, function () {\n                            this.initStage(stageInfo.bigStage);\n                        }.bind(this))\n                    }\n                    if (goGame != null) {\n                        goGame.active = false;\n                    }\n                }.bind(this))\n            } else {\n                SDK().getItem(\"hearts\", function (heart) {\n                    //体力充足\n                    if (heart > 0) {\n                        //消耗一个体力\n                        heart = heart - 1;\n                        SDK().setItem({ hearts: heart });\n                        if (this.hearts != null) {\n                            this.hearts.getComponent(cc.Label).string = heart;\n                        }\n                        window.gameApplication.flyReward(1, \"heartSprite\", item, this.hearts, function () {\n                            this.goGame(stageInfo, item, islock);\n                        }.bind(this))\n                    } else {\n                        //体力不足需要获得\n                        window.gameApplication.showHeartView(function (isComplited) {\n                            if (isComplited) {\n                                heart = 4;\n                                if (this.hearts != null) {\n                                    this.hearts.getComponent(cc.Label).string = heart;\n                                }\n                                SDK().setItem({ hearts: heart });\n                                window.gameApplication.flyReward(1, \"heartSprite\", item, this.hearts, function () {\n                                    this.goGame(stageInfo, item, islock);\n                                }.bind(this))\n                            } else {\n                                if (goGame != null) {\n                                    goGame.active = false;\n                                }\n                            }\n                        }.bind(this), false)\n                    }\n                }.bind(this));\n            }\n        }, this);\n    },\n\n    goGame(stageInfo, item, islock) {\n        //开始游戏\n        window.bid = 1;\n        window.mid = stageInfo.mid;\n        window.lid = stageInfo.lid;\n        this.gameApplication.openGameView();\n    },\n\n    //判断关卡类型\n    judgeType(stage) {\n        var count = 0;\n        var disVal = 60;\n        var isFix = false;\n\n        //如果关卡大于300时，直接不要第六章节\n        if (stage >= 300) {\n            stage = stage - 300;\n            isFix = true;\n            disVal = 50;\n        }\n        while (stage >= disVal) {\n            stage = stage - disVal;\n            count = count + 1;\n        }\n        stage = Math.floor(stage / 10);\n\n        var param = {};\n        param.type = stage;\n        param.count = count;\n        param.bigStage = (stage * 10) + (count * disVal);\n        if (isFix) {\n            param.bigStage = param.bigStage + 300;\n        }\n        return param;\n    },\n\n    //根据关卡数判断mid 和 lid\n    judgeML(curMission, i) {\n        var info = {};\n        info.mid = curMission.type + 1;\n        var fixCount = 0;\n        if (curMission.bigStage >= 300) {\n            fixCount = 5;\n        }\n        info.lid = 1 + i + ((fixCount + curMission.count) * 10);\n        return info;\n    },\n\n    hideAllItem() {\n        if (this.content.childrenCount > 0) {\n            //如果有child，destroy\n            this.content.children.forEach(function (n) {\n                n.active = false;\n                n.destroy();\n            });\n        }\n    },\n\n    menuClick(event, type) {\n        window.gameApplication.soundManager.playSound(\"btn_click\")\n        if (type == \"addHeart\") {\n            window.gameApplication.showHeartView(function (isComplited) {\n                if (isComplited) {\n                    SDK().getItem(\"hearts\", function (heart) {\n                        heart = heart + 5;\n                        window.gameApplication.flyReward(5, \"heartSprite\", window.mainScirpt.hearts, null);\n                        if (this.hearts != null) {\n                            this.hearts.getComponent(cc.Label).string = heart;\n                        }\n                        SDK().setItem({ hearts: heart });\n                    }.bind(this), false)\n                }\n            }.bind(this), false)\n        } else if (type == \"addCoin\") {\n            window.gameApplication.showCoinView(function (isCompleted) {\n                if (isCompleted) {\n                    SDK().getItem(\"coins\", function (coin) {\n                        coin = coin + 100;\n                        window.gameApplication.flyReward(10, \"coin\", window.mainScirpt.coins, null);\n                        if (this.coins != null) {\n                            this.coins.getComponent(cc.Label).string = coin;\n                        }\n                        SDK().setItem({ coins: coin });\n                    }.bind(this), false)\n                }\n            }.bind(this), false)\n        } else if (type == \"goCur\") {\n            var curMission = this.judgeType(window.curIdx);\n            var bigStage = curMission.bigStage;\n            var cannonNode = this.missionNodes[bigStage];\n            if (cannonNode == null) {\n                return;\n            }\n            var height = 995;\n            var fix = window.curIdx - curMission.bigStage;\n            height = height * (-fix + 5) / 10;\n            var maxScrollOffset = this.scrollView.getMaxScrollOffset();\n            this.scrollView.scrollToOffset(cc.v2(0, maxScrollOffset.y - cannonNode.y + height), 0.5);\n        } else if (type == \"reHeart\") {\n            if (parseInt(this.reviveNum.string) == 0) {\n                return;\n            }\n            this.reviveNum.string = 0;\n            SDK().getItem(\"reHeart\", function (count) {\n\n                //将可获得的体力置零\n                SDK().setItem({ reHeart: 0 }, function () {\n\n                    //增加体力\n                    SDK().getItem(\"hearts\", function (Heart) {\n                        Heart = parseInt(Heart);\n                        Heart = Heart + count;\n                        if (Math.abs(this.node.y - 0) < 10) {\n                            window.gameApplication.flyReward(count, \"heartSprite\", window.mainScirpt.hearts, this.reviveBtn.node, function () {\n                                if (null != window.mainScirpt.hearts) {\n                                    window.mainScirpt.hearts.getComponent(cc.Label).string = Heart.toString();\n                                }\n                            }.bind(this));\n                        }\n                        SDK().setItem({ hearts: Heart }, null);\n                    }.bind(this));\n\n                }.bind(this));\n\n            }.bind(this));\n\n        }\n    },\n\n    reviveHeartCount() {\n        if (this.reTime <= 0) {\n            this.reTime = 300;\n            SDK().getItem(\"reHeart\", function (count) {\n                count = count + 1;\n                this.reviveNum.string = count;\n                SDK().setItem({ reHeart: count });\n            }.bind(this));\n        } else {\n            var temp = this.reTime;\n            var tempMin = temp / 60;\n            var min = temp / 60 < 10 ? \"0\" + Math.floor(temp / 60) : \"\" + Math.floor(temp / 60);\n            var sec = temp % 60 < 10 ? \"0\" + Math.floor(temp % 60) : \"\" + Math.floor(temp % 60);\n            if (temp <= 0) {\n                min = \"00\";\n                sec = \"00\"\n            }\n            this.reviveTime.string = min + \":\" + sec;\n        }\n        this.scheduleOnce(function () {\n            this.reviveHeartCount();\n        }.bind(this), 1)\n    },\n\n    update(dt) {\n        this.reTime = this.reTime - dt;\n    },\n});\n"]}